<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL"
    xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
    xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
    xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
    xmlns:drools="http://www.jboss.org/drools"
    id="Definition"
    targetNamespace="http://www.example.org/task-process">

  <bpmn2:process id="task-process" name="Proceso de Tareas" isExecutable="true">

    <!-- Inicio -->
    <bpmn2:startEvent id="StartEvent_1" name="Inicio">
      <bpmn2:outgoing>Flow_1</bpmn2:outgoing>
    </bpmn2:startEvent>

    <!-- Crear tarea -->
    <bpmn2:userTask id="UserTask_1" name="Crear Tarea">
      <bpmn2:incoming>Flow_1</bpmn2:incoming>
      <bpmn2:outgoing>Flow_2</bpmn2:outgoing>
    </bpmn2:userTask>

    <!-- Decisión -->
    <bpmn2:exclusiveGateway id="Gateway_1" name="Decisión" gatewayDirection="Diverging">
      <bpmn2:incoming>Flow_2</bpmn2:incoming>
      <bpmn2:outgoing>Flow_3</bpmn2:outgoing>
      <bpmn2:outgoing>Flow_4</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>

    <!-- Revisar tarea -->
    <bpmn2:userTask id="UserTask_2" name="Revisar Tarea">
      <bpmn2:incoming>Flow_3</bpmn2:incoming>
      <bpmn2:outgoing>Flow_5</bpmn2:outgoing>
    </bpmn2:userTask>

    <!-- Unión -->
    <bpmn2:exclusiveGateway id="Gateway_2" name="Unión" gatewayDirection="Converging">
      <bpmn2:incoming>Flow_4</bpmn2:incoming>
      <bpmn2:incoming>Flow_5</bpmn2:incoming>
      <bpmn2:outgoing>Flow_6</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>

    <!-- Fin -->
    <bpmn2:endEvent id="EndEvent_1" name="Fin">
      <bpmn2:incoming>Flow_6</bpmn2:incoming>
    </bpmn2:endEvent>

    <!-- Flujos -->
    <bpmn2:sequenceFlow id="Flow_1" sourceRef="StartEvent_1" targetRef="UserTask_1"/>
    <bpmn2:sequenceFlow id="Flow_2" sourceRef="UserTask_1" targetRef="Gateway_1"/>

    <!-- Condición: Ir a revisión -->
    <bpmn2:sequenceFlow id="Flow_3" sourceRef="Gateway_1" targetRef="UserTask_2" name="Ir a revisión">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[#{status == "Revisar"}]]></bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>

    <!-- Condición: Finalizar directo -->
    <bpmn2:sequenceFlow id="Flow_4" sourceRef="Gateway_1" targetRef="Gateway_2" name="Finalizar directo">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[#{status == "Finalizar"}]]></bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>

    <bpmn2:sequenceFlow id="Flow_5" sourceRef="UserTask_2" targetRef="Gateway_2"/>
    <bpmn2:sequenceFlow id="Flow_6" sourceRef="Gateway_2" targetRef="EndEvent_1"/>

  </bpmn2:process>

  <!-- Diagrama para Business Central -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_task_process">
    <bpmndi:BPMNPlane id="BPMNPlane_task_process" bpmnElement="task-process">

      <bpmndi:BPMNShape id="StartEvent_1_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="100" y="200" width="36" height="36"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="UserTask_1_di" bpmnElement="UserTask_1">
        <dc:Bounds x="200" y="180" width="100" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="Gateway_1_di" bpmnElement="Gateway_1" isMarkerVisible="true">
        <dc:Bounds x="350" y="195" width="50" height="50"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="UserTask_2_di" bpmnElement="UserTask_2">
        <dc:Bounds x="450" y="100" width="100" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="Gateway_2_di" bpmnElement="Gateway_2" isMarkerVisible="true">
        <dc:Bounds x="650" y="195" width="50" height="50"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="EndEvent_1_di" bpmnElement="EndEvent_1">
        <dc:Bounds x="800" y="200" width="36" height="36"/>
      </bpmndi:BPMNShape>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</bpmn2:definitions>